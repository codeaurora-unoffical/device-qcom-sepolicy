# for diag over socket
userdebug_or_eng(`
  allow kernel self:socket create;
  allow kernel debugfs_wlan:dir search;
  allow kernel debugfs_ipc:dir search;
')

# Access firmware_file
r_dir_file(kernel, firmware_file)


# access vendor_firmware_file
r_dir_file(kernel, vendor_firmware_file)

dontaudit kernel kernel:system module_request;

allow kernel persist_file:dir search;

allow kernel device:chr_file { create setattr };
allow kernel device:dir { add_name write };
allow kernel self:capability mknod;

