allow system_server self:socket ioctl;
allowxperm system_server self:socket ioctl msm_sock_ipc_ioctls;

binder_call(system_server, hal_camera_default)

allow system_server persist_file:dir search;
allow system_server persist_sensors_file:dir search;
allow system_server persist_sensors_file:file r_file_perms;
allow system_server wlan_device:chr_file rw_file_perms;
allow system_server hal_audio_default:file w_file_perms;

allow system_server sysfs_sensors:dir search;
allow system_server sysfs_sensors:file rw_file_perms;
binder_call(system_server, mm-pp-daemon)
# allow access to low persistence mode sysfs node
allow system_server sysfs_graphics:file rw_file_perms;
userdebug_or_eng(`
    diag_use(system_server)
')

# allow read ro.radio.noril peop
allow system_server radio_noril_prop:file { open read getattr };
get_prop(system_server, vendor_default_prop)
allow system_server proc_cmdline:file r_file_perms;
